<routes xmlns="http://camel.apache.org/schema/spring">
    <route id="sync-response-processor" errorHandlerRef="shutdownErrorHandler">

        <from uri="direct:sync-response-processor" />

        <log message="Fetching next 500 sync responses" loggingLevel="DEBUG" />

        <toD uri="jpa:SenderSyncResponse?query=SELECT r FROM SenderSyncResponse r ORDER BY r.dateCreated, r.id ASC&amp;maximumResults=500" />

        <choice>
            <when>
                <simple>${body.size()} > 0</simple>
                <log message="Fetched ${body.size()} sender sync response(s)" />
                
                <process ref="syncResponseProcessor" />
            </when>
            <otherwise>
                <log message="No sender sync responses was found" loggingLevel="DEBUG" />
            </otherwise>
        </choice>
        
    </route>
</routes>
